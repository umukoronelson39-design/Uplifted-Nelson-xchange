<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Uplifted Nelson Xchange</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0a66c2" />
  <link rel="manifest" href="manifest.json" />

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #f2f4f8;
    }
    header {
      background: #0a66c2;
      color: white;
      padding: 18px;
      text-align: center;
    }
    section {
      padding: 15px;
    }
    .card {
      background: white;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    }
    button {
      width: 100%;
      padding: 12px;
      background: #0a66c2;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      margin-top: 10px;
    }
    .sell {
      background: #28a745;
    }
    /* Login styles */
    #loginScreen {
      padding: 20px;
      max-width: 400px;
      margin: auto;
    }
    #loginScreen input {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
    }
    #loginScreen button {
      width: 100%;
      padding: 12px;
      background: #0a66c2;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
    }
    #loginError {
      color: red;
      display: none;
      margin-top: 10px;
    }
    #appContent {
      display: none;
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
  </style>
</head>

<body>

  <!-- Login Screen -->
  <div id="loginScreen">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username" />
    <input type="password" id="password" placeholder="Password" />
    <button onclick="login()">Log In</button>
    <p id="loginError">Invalid username or password</p>
  </div>

  <!-- Main App Content -->
  <div id="appContent">
    <header>
      <h2>Uplifted Nelson Xchange</h2>
      <p>Buy & Sell Bitcoin • Gift Cards</p>
    </header>

    <section>
      <div class="card">
        <h3>Submit Trade Request</h3>

        <label>Trade Type</label>
        <select id="type">
          <option>Bitcoin</option>
          <option>Gift Card</option>
        </select>

        <label>Amount</label>
        <input type="number" id="amount" placeholder="Enter amount" />

        <label>Details</label>
        <textarea id="details" placeholder="Gift card type or BTC wallet info"></textarea>

        <button onclick="submitTrade()">Submit Trade</button>
      </div>

      <div class="card">
        <h3>Live Rate Calculator</h3>
        <input type="number" id="calcAmount" placeholder="Enter amount" />
        <button onclick="calculate()">Calculate</button>
        <p id="result"></p>
      </div>
    </section>
  </div>

  <script>
    // Simple hardcoded credentials
    const validUsername = "user";
    const validPassword = "password";

    function login() {
      const username = document.getElementById("username").value.trim();
      const password = document.getElementById("password").value.trim();

      if (username === validUsername && password === validPassword) {
        document.getElementById("loginScreen").style.display = "none";
        document.getElementById("appContent").style.display = "block";
        document.getElementById("loginError").style.display = "none";
      } else {
        document.getElementById("loginError").style.display = "block";
      }
    }

    function submitTrade() {
      let type = document.getElementById("type").value;
      let amount = document.getElementById("amount").value;
      let details = document.getElementById("details").value;

      let msg = `NEW TRADE REQUEST\nType: ${type}\nAmount: ${amount}\nDetails: ${details}`;

      window.location.href = `https://wa.me/2348174027335?text=${encodeURIComponent(
        msg
      )}`;
    }

    function calculate() {
      let amt = document.getElementById("calcAmount").value;
      let rate = 1200; // example rate
      document.getElementById("result").innerHTML = "Estimated value: ₦" + amt * rate;
    }

    // Register Service Worker
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker
          .register("/sw.js")
          .then((reg) => {
            console.log("Service Worker registered.");
          })
          .catch((err) => {
            console.log("Service Worker registration failed: ", err);
          });
      });
    }
  </script>
</body>
</html>